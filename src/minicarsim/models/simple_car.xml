<mujoco model="simple_car">
  <compiler angle="radian" inertiafromgeom="true"/>

  <option timestep="0.005" gravity="0 0 -9.81" iterations="200" solver="Newton" cone="elliptic" impratio="5" viscosity="0.1"/>

  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <rgba haze="0.871 0.616 0.4 0.5"/>
    <global azimuth="-130" elevation="-20"/>
  </visual>

  <asset>
    <texture builtin="gradient" height="100" rgb1="0.9 0.9 0.9" rgb2="0.549 0.251 0.0" type="skybox" width="100"/>
    <texture name="texplane" type="2d" builtin="checker" rgb1="0.5 0.5 0.5" rgb2="0.55 0.55 0.55" width="100" height="100"/>
    <material name="MatPlane" reflectance="0.0" texture="texplane" texrepeat="1 1" texuniform="true"/>
    <material name="car_body" rgba="0.2 0.2 0.8 1"/>
    <material name="car_wheels" rgba="0.1 0.1 0.1 1"/>
    <material name="obstacle_red" rgba="0.8 0.2 0.2 1"/>
    <material name="obstacle_green" rgba="0.2 0.8 0.2 1"/>
    <material name="obstacle_blue" rgba="0.2 0.2 0.8 1"/>
    <material name="obstacle_yellow" rgba="0.8 0.8 0.2 1"/>
  </asset>

  <worldbody>
    <!-- 地面平面 -->
    <geom name="floor" friction="2.0 .1 .1" pos="0 0 0" size="0 0 0.125" type="plane" material="MatPlane" condim="3" conaffinity="1" contype="1" group="2" rgba="0.8 0.9 0.8 1" solref="0.08 1"/>
    <!-- 光照设置 -->
    <light cutoff="1000" diffuse="1.5 1.5 1.5" dir="-0 0 -1.3" directional="true" exponent="10" pos="0 0 10.3" specular=".1 .1 .1" castshadow="false"/>

    <!-- 小车主体 -->
    <body name="vehicle" pos="0 0 0.3">
      <!-- 自由关节，允许小车在空间中自由移动 -->
      <freejoint name="vehicle_joint"/>

      <!-- 车身底盘 -->
      <geom name="chassis" type="box" size="1 0.5 0.2" material="car_body" mass="15" friction="0.2 0.1 0.1" solref="0.08 1"/>
      <!-- 车厢 -->
      <geom name="cabin" type="box" size="0.6 0.4 0.3" pos="0.1 0 0.3" material="car_body" mass="5"/>

      <!-- 前轮 -->
      <body name="front_left_wheel" pos="0.8 0.6 -0.1">
        <!-- 轮子关节，绕Y轴旋转 -->
        <joint name="front_left_wheel_joint" type="hinge" axis="0 1 0" limited="false"/>
        <!-- 轮子几何体，圆柱形 -->
        <geom name="front_left_wheel_geom" type="cylinder" size="0.2 0.05" material="car_wheels" mass="1.5" friction="2.0 0.1 0.1" solref="0.08 1"/>
      </body>

      <body name="front_right_wheel" pos="0.8 -0.6 -0.1">
        <joint name="front_right_wheel_joint" type="hinge" axis="0 1 0" limited="false"/>
        <geom name="front_right_wheel_geom" type="cylinder" size="0.2 0.05" material="car_wheels" mass="1.5" friction="2.0 0.1 0.1" solref="0.08 1"/>
      </body>

      <!-- 后轮 -->
      <body name="rear_left_wheel" pos="-0.8 0.6 -0.1">
        <joint name="rear_left_wheel_joint" type="hinge" axis="0 1 0" limited="false"/>
        <geom name="rear_left_wheel_geom" type="cylinder" size="0.2 0.05" material="car_wheels" mass="1.5" friction="2.0 0.1 0.1" solref="0.08 1"/>
      </body>

      <body name="rear_right_wheel" pos="-0.8 -0.6 -0.1">
        <joint name="rear_right_wheel_joint" type="hinge" axis="0 1 0" limited="false"/>
        <geom name="rear_right_wheel_geom" type="cylinder" size="0.2 0.05" material="car_wheels" mass="1.5" friction="2.0 0.1 0.1" solref="0.08 1"/>
      </body>

      <!-- LiDAR传感器安装位置 -->
      <site name="lidar_site" pos="0 0 0.8" type="sphere" size="0.05"/>

      <!-- 摄像头传感器安装位置 -->
      <site name="camera_site" pos="1.2 0 0.7" type="sphere" size="0.05"/>
    </body>

    <!-- More obstacles for object detection -->
    <body name="obstacle1" pos="5 2 0.3">
      <geom name="obstacle1_geom" type="box" size="0.5 0.5 0.5" material="obstacle_red" mass="5"/>
    </body>

    <body name="obstacle2" pos="8 -3 0.3">
      <geom name="obstacle2_geom" type="box" size="0.5 0.5 0.5" material="obstacle_green" mass="5"/>
    </body>

    <body name="obstacle3" pos="-3 4 0.3">
      <geom name="obstacle3_geom" type="box" size="0.5 0.5 0.5" material="obstacle_blue" mass="5"/>
    </body>

    <body name="obstacle4" pos="10 5 0.3">
      <geom name="obstacle4_geom" type="box" size="0.5 0.5 0.5" material="obstacle_yellow" mass="5"/>
    </body>

    <body name="obstacle5" pos="-5 -2 0.3">
      <geom name="obstacle5_geom" type="box" size="0.5 0.5 0.5" material="obstacle_red" mass="5"/>
    </body>
  </worldbody>

  <actuator>
    <!-- 后轮驱动电机 -->
    <velocity name="rear_left_wheel_motor" joint="rear_left_wheel_joint" kv="5.0"/>
    <velocity name="rear_right_wheel_motor" joint="rear_right_wheel_joint" kv="5.0"/>

    <!-- 前轮转向伺服电机 -->
    <position name="front_left_steering" joint="front_left_wheel_joint" kp="15"/>
    <position name="front_right_steering" joint="front_right_wheel_joint" kp="15"/>
  </actuator>

  <sensor>
    <!-- IMU惯性测量单元数据 -->
    <accelerometer name="accelerometer" site="lidar_site"/>
    <gyro name="gyro" site="lidar_site"/>
    <!-- 温度传感器 -->
    <framepos name="temperature_sensor" objtype="site" objname="lidar_site"/>
  </sensor>
</mujoco>