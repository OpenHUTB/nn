<launch>
    <!-- CARLA跟踪节点 -->
    <node name="carla_tracking_node" 
          pkg="carla_tracking" 
          type="carla_ros_node.py" 
          output="screen"
          respawn="false">
        <!-- 参数配置 -->
        <param name="config_path" value="$(find carla_tracking)/config/carla_config.json" />
        <param name="npc_count" value="20" />
        <param name="target_speed" value="30.0" />
        
        <!-- CARLA服务器参数 -->
        <param name="carla_host" value="localhost" />
        <param name="carla_port" value="2000" />
        
        <!-- 检测模型参数 -->
        <param name="model_type" value="yolov5m" />
        <param name="conf_thres" value="0.15" />
    </node>

    <!-- 可选：RViz可视化 -->
    <node name="rviz" 
          pkg="rviz" 
          type="rviz" 
          args="-d $(find carla_tracking)/config/rviz_config.rviz" 
          output="screen"
          unless="$(arg no_rviz)" />

    <!-- 可选：图像查看器 -->
    <node name="image_view_rgb" 
          pkg="image_view" 
          type="image_view" 
          respawn="false" >
        <remap from="image" to="/carla/camera/rgb" />
        <param name="window_name" value="CARLA RGB Camera" />
    </node>

    <node name="image_view_tracks" 
          pkg="image_view" 
          type="image_view" 
          respawn="false" >
        <remap from="image" to="/carla/tracking/info" />
        <param name="window_name" value="CARLA Tracking Results" />
    </node>
</launch>
