

# 卷积神经网络(CNN)



## 问题描述：

利用卷积神经网络，实现对MNIST 数据集的分类问题。




## 数据集: 

 	MNIST数据集包括60000张训练图片和10000张测试图片。图片样本的数量已经足够训练一个很复杂的模型（例如 CNN的深层神经网络）。它经常被用来作为一个新 的模式识别模型的测试用例。而且它也是一个方便学生和研究者们执行用例的数据集。除此之外，MNIST数据集是一个相对较小的数据集，可以在你的笔记本CPUs上面直接执行





## 题目要求： 

tensorflow版的卷积神经网路 conv2d() 和max_pool_2x2()函数，然后补全两层卷积的 8个空；

pytorch版本的卷积神经网络 需要补齐  self.conv1 中 nn.Conv2d( )  和 self.conv2( ) 的参数，还需要填写 x = x.view( )中的内容。

两个版本的训练精度都应该在 96% 以上。

---

## CNN_pytorch.py简介
本代码使用PyTorch实现了一个卷积神经网络（CNN），用于对MNIST手写数字数据集进行分类。代码包含数据加载、模型定义、训练和测试流程，适合初学者学习基本的深度学习流程和PyTorch框架的使用。

---

## 超参数说明
| 参数名           | 默认值 | 说明                      |
| ---------------- | ------ | ------------------------- |
| `learning_rate`  | 1e-4   | 优化器学习率              |
| `keep_prob_rate` | 0.7    | Dropout层保留神经元的比例 |
| `max_epoch`      | 3      | 训练轮数                  |
| `BATCH_SIZE`     | 50     | 每批训练数据量            |

---

## 模型结构
1. **卷积层1**：
   - 输入通道：1（灰度图）
   - 输出通道：32
   - 卷积核：7x7，步长1，填充3（保持尺寸）
   - 激活函数：ReLU
   - 池化：2x2最大池化（尺寸减半）

2. **卷积层2**：
   - 输入通道：32
   - 输出通道：64
   - 卷积核：5x5，步长1，填充2
   - 激活函数：ReLU
   - 池化：2x2最大池化

3. **全连接层**：
   - 输入：7x7x64 → 1024维
   - Dropout（保留比例0.7）
   - 输出：1024 → 10维（对应10个类别）

---

## 代码说明
- **数据加载**：自动下载MNIST数据集，分为训练集（60,000张）和测试集（500张样本用于验证）。
- **训练流程**：
  - 使用Adam优化器和交叉熵损失函数。
  - 每20个batch打印一次测试准确率。
- **测试流程**：计算模型在测试集上的分类准确率。

---

## 预期结果
- 训练3轮后，测试准确率约**98%~99%**（实际结果可能因随机性略有差异）。
- 输出示例：
  ```
  ========== 1000 ===== ===== 测试准确率:  0.966 ==========
  ========== 1020 ===== ===== 测试准确率:  0.974 ==========
  ========== 1040 ===== ===== 测试准确率:  0.974 ==========
  ========== 1060 ===== ===== 测试准确率:  0.976 ==========
  ========== 1080 ===== ===== 测试准确率:  0.98 ==========
  ========== 1100 ===== ===== 测试准确率:  0.968 ==========
  ========== 1120 ===== ===== 测试准确率:  0.974 ==========
  ========== 1140 ===== ===== 测试准确率:  0.976 ==========
  ========== 1160 ===== ===== 测试准确率:  0.974 ==========
  ========== 1180 ===== ===== 测试准确率:  0.968 ==========
  
  进程已结束，退出代码为 0
  ```

---

