# 预训练模型使用指南

## 模型概述

本文档提供了预训练模型的详细信息和使用方法。这个模型是一个基于CNN的DQN（深度Q网络）模型，用于Car Racing环境中的自动驾驶控制。

## 模型信息

- **模型路径**: `data/pretrained_model.weights.h5`
- **模型类型**: CNN + DQN
- **输入形状**: (96, 96, 3) - 游戏屏幕截图
- **输出**: 5个可能的动作值（Q值）
- **动作空间**: 
  - 转向: [-1.0, -0.5, 0.00, 0.5, 1.0]
  - 加速: [1.0]
  - 刹车: [0.75]

## 使用方法

### 1. 加载模型进行训练

使用以下命令加载预训练模型并继续训练：

```bash
python main.py --load-model=data/pretrained_model.weights.h5 --start-episode=1
```

这将从第一回合开始训练，使用预训练的权重作为起点。

### 2. 验证模型

可以使用提供的脚本验证模型是否正常工作：

```bash
python use_pretrained_model.py
```

这个脚本会加载模型并执行一次简单的推理测试。

## 重要说明

- **模型状态**: 这是一个初始化的预训练模型，包含随机初始化的权重。它需要进一步训练才能获得良好的性能。
- **训练建议**:
  - 建议至少训练100-200个回合以获得基本的驾驶能力
  - 训练过程中会自动保存每10回合的模型
  - 训练时可调整负奖励阈值（在main.py中）来控制每回合的训练长度

## 文件说明

- `generate_pretrained_model.py`: 用于生成预训练模型的脚本
- `use_pretrained_model.py`: 用于验证和测试预训练模型的脚本
- `data/pretrained_model.weights.h5`: 预训练模型权重文件

## 故障排除

- **无法加载模型**: 确保路径正确，模型文件存在于data目录中
- **训练效果不佳**: 增加训练回合数，或调整学习率、批次大小等超参数

## 性能期望

初始化模型不会有良好的表现，需要通过强化学习过程进行训练。训练后的模型应该能够：
- 保持在赛道内行驶
- 适应不同的赛道地形
- 避免撞墙和驶出赛道

祝训练愉快！